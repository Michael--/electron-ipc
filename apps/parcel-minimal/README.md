# Parcel Minimal - electron-ipc Demo

Minimal Electron app demonstrating **@number10/electron-ipc** with **Parcel 2.x** bundler.

## Features

- ✅ Type-safe IPC communication with electron-ipc
- ✅ Zero-config bundling with Parcel 2.x
- ✅ Fast HMR (Hot Module Replacement)
- ✅ TypeScript support out of the box
- ✅ Separate build targets for main/preload/renderer

## Project Structure

```
parcel-minimal/
├── src/
│   ├── main/
│   │   ├── ipc-config.yaml        # IPC API schema
│   │   ├── ipc-api.ts             # Type contracts
│   │   └── index.ts               # Main process + handlers
│   ├── preload/
│   │   └── index.ts               # Preload script (bridge)
│   └── renderer/
│       ├── index.html             # UI
│       └── renderer.ts            # Renderer logic
├── dist/                          # Generated code
│   └── ipc-api.generated.ts       # Auto-generated by electron-ipc
├── out/                           # Bundled output
├── .parcelrc                      # Parcel configuration
├── package.json                   # Scripts + dependencies
└── tsconfig.json                  # TypeScript config
```

## Scripts

```bash
# Install dependencies
pnpm install

# Generate IPC code from schema
pnpm run generate

# Build for production
pnpm run build

# Start the app
pnpm start

# Type checking
pnpm run typecheck
```

## IPC Demonstrations

### 1. Basic Invoke/Handle

```typescript
// Renderer
const result = await api.invokeping({ message: 'Hello' })
// Main handles via ipcMain.handle('ping', ...)
```

### 2. Request with Parameters

```typescript
// Renderer
const data = await api.invokegetData({ id: 123 })
// Main returns structured data
```

### 3. Events from Main → Renderer

```typescript
// Renderer listens
api.onnotification((event) => { ... })
// Main broadcasts via webContents.send('notification', ...)
```

## Parcel-Specific Features

### Build Targets

Defined in `package.json`:

```json
{
  "targets": {
    "main": { "source": "src/main/index.ts" },
    "preload": { "source": "src/preload/index.ts", "context": "electron-preload" },
    "renderer": { "source": "src/renderer/index.html", "context": "electron-renderer" }
  }
}
```

### Zero Configuration

- No webpack config files needed
- No complex loaders/plugins
- TypeScript works automatically via `.parcelrc`

### Fast Builds

- Native code (Rust-based SWC compiler)
- Parallel processing
- Smart caching

## Comparison with Other Bundlers

| Feature            | esbuild            | webpack                 | **Parcel**                |
| ------------------ | ------------------ | ----------------------- | ------------------------- |
| Config Complexity  | Low (build script) | High (separate configs) | **Lowest (targets only)** |
| Build Speed        | ⚡️ Fastest        | Slower                  | Fast                      |
| TypeScript Support | Manual             | ts-loader               | **Built-in**              |
| HMR                | Manual setup       | Requires config         | **Out of the box**        |
| Learning Curve     | Low                | High                    | **Lowest**                |
| Ecosystem          | Growing            | Largest                 | Growing                   |

## Why Parcel?

1. **Zero Configuration**: No webpack.config.js, no complex setup
2. **Modern by Default**: Uses latest standards automatically
3. **Fast Development**: Built-in HMR and caching
4. **TypeScript Native**: No loader configuration needed
5. **Simple Targets**: Define entry points in package.json

## Dependencies

```json
{
  "electron": "^28.0.0",
  "parcel": "^2.12.0",
  "@number10/electron-ipc": "workspace:*"
}
```

## How It Works

1. **Schema Definition**: Define IPC API in `ipc-config.yaml`
2. **Code Generation**: Run `electron-ipc-generate` to create type-safe API
3. **Main Process**: Implement handlers using `ipcMain.handle()`
4. **Preload**: Use `exposeApi()` to bridge IPC to renderer
5. **Renderer**: Use generated `api` object with full TypeScript support
6. **Parcel Bundling**: Build targets automatically with `parcel build`

## License

MIT
